<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Pelis - UAGRO | Pel√≠culas</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
<header class="site-header">
    <div class="logo-area">
        <span class="logo-icon">ü¶Ö</span>
        <span class="logo-text">Pelis - UAGRO</span>
    </div>

    <nav class="main-nav">
        <a href="{{ url_for('home') }}" class="nav-link">Inicio</a>
        <a href="{{ url_for('peliculas') }}" class="nav-link">Pel√≠culas</a>
        <a href="{{ url_for('cuenta') }}" class="nav-link">Mi cuenta</a>
    </nav>

    <div class="user-area">
        {% if session.get('usuario_nombre') %}
            {% set primer_nombre = session['usuario_nombre'].split(' ')[0] %}
            <div class="user-menu">
                <button class="btn-login user-menu-toggle">
                    {{ primer_nombre }}
                </button>
                <div class="user-menu-dropdown">
                    <a href="{{ url_for('cuenta') }}">Configuraci√≥n</a>
                    <a href="{{ url_for('logout') }}">Cerrar sesi√≥n</a>
                </div>
            </div>
        {% else %}
            <a href="{{ url_for('login') }}" class="btn-login">Iniciar sesi√≥n</a>
        {% endif %}
    </div>
</header>

<main class="main-content">
    <h1 class="row-title">Pel√≠culas</h1>
    <p class="hero-description">
        Estas pel√≠culas vienen directamente de la base de datos <strong>Movies.dbo.mymoviedb</strong>.
    </p>

    <section class="row" style="margin-top: 20px;">
        <h2 class="row-title">Cat√°logo</h2>
        <div class="row-cards">
            {% for peli in peliculas %}
                <article class="movie-card">
                    <div class="movie-cover"
                         style="
                         {% if peli.poster %}
                             background-image: url('{{ peli.poster }}');
                             background-size: cover;
                             background-position: center;
                         {% endif %}
                         ">
                    </div>
                    <h3 class="movie-title">{{ peli.titulo }}</h3>
                    <p class="movie-meta">
                        {{ peli.genero }} ‚Ä¢ {{ peli.fecha }}<br>
                        ‚≠ê {{ peli.promedio }} ({{ peli.votos }} votos)
                    </p>
                </article>
            {% else %}
                <p>No hay pel√≠culas para mostrar.</p>
            {% endfor %}
        </div>
    </section>
</main>
</body>
<script>
    document.addEventListener('click', function (e) {
        const toggle = document.querySelector('.user-menu-toggle');
        const dropdown = document.querySelector('.user-menu-dropdown');

        if (!toggle || !dropdown) return;

        if (toggle.contains(e.target)) {
            const isVisible = dropdown.style.display === 'block';
            dropdown.style.display = isVisible ? 'none' : 'block';
        } else if (!dropdown.contains(e.target)) {
            dropdown.style.display = 'none';
        }
    });
</script>
</html>